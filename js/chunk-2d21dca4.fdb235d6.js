(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d21dca4"],{d398:function(t,a,s){"use strict";s.r(a);var e=function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("div",{staticClass:"container"},[s("Loading",{attrs:{active:t.isLoading},on:{"update:active":function(a){t.isLoading=a}}}),s("div",{staticClass:"row justify-content-center my-5"},[s("div",{staticClass:"col-md-6 bg-transparent py-5"},[s("div",{staticClass:"p-2 border",staticStyle:{"min-height":"calc(100vh - 56px - 76px)"}},[s("div",{staticClass:"d-flex justify-content-between align-items-end border-bottom pb-3"},[s("h2",{staticClass:"mt-2"},[t._v("購物車列表 ")]),s("button",{staticClass:"btn btn-outline-secondary btn-sm",attrs:{type:"button"},on:{click:function(a){return t.deleteAllCartItem()}}},[s("i",{staticClass:"far fa-trash-alt"},[t._v(" 清空購物車")])])]),t._l(t.carts,(function(a){return s("div",{key:a.product.id+1,staticClass:"d-flex align-items-center py-3 bg-transparent border-bottom"},[s("img",{staticStyle:{width:"120px",height:"120px","object-fit":"cover"},attrs:{src:a.product.imageUrl,alt:""}}),s("div",{staticClass:"w-100 p-3 position-relative"},[s("a",{staticClass:"position-absolute",staticStyle:{top:"16px",right:"16px"},attrs:{href:"#"},on:{click:function(s){return s.preventDefault(),t.removeItem(a.product.id)}}},[s("i",{staticClass:"fas fa-times"})]),s("span",{staticClass:"badge badge-secondary badge-pill text-white font-weight-light mb-1"},[t._v(" "+t._s(a.product.category)+" ")]),s("p",{staticClass:"mb-1 font-weight-bold"},[t._v(t._s(a.product.title))]),s("p",{staticClass:"mb-1 text-muted",staticStyle:{"font-size":"14px"}},[t._v(t._s(a.product.content))]),s("div",{staticClass:"d-flex justify-content-between align-items-center w-100"},[s("div",{staticClass:"input-group w-50 align-items-center",staticStyle:{"background-color":"#191b1d"}},[s("div",{staticClass:"input-group-prepend pr-1"},[s("button",{staticClass:"btn",attrs:{type:"button",disabled:1===a.quantity},on:{click:function(s){a.quantity--,t.updateQuantity(a.product.id,a.quantity)}}},[s("i",{staticClass:"fas fa-minus"})])]),s("input",{directives:[{name:"model",rawName:"v-model",value:a.quantity,expression:"item.quantity"}],staticClass:"form-control border-0 text-center my-auto shadow-none bg-transparent text-white px-0",attrs:{type:"text",placeholder:"","aria-label":"Example text with button addon","aria-describedby":"button-addon1",value:"1",readonly:""},domProps:{value:a.quantity},on:{change:function(s){return t.updateQuantity(a.product.id,a.quantity)},input:function(s){s.target.composing||t.$set(a,"quantity",s.target.value)}}}),s("div",{staticClass:"input-group-append pl-1"},[s("button",{staticClass:"btn",attrs:{type:"button",disabled:a.quantity>=20},on:{click:function(s){a.quantity++,t.updateQuantity(a.product.id,a.quantity)}}},[s("i",{staticClass:"fas fa-plus"})])])]),s("p",{staticClass:"mb-0 ml-auto"},[t._v("$"+t._s(a.product.price))])])])])})),s("table",{staticClass:"table mt-4 text-muted"},[s("tbody",[s("tr",[s("th",{staticClass:"border-0 px-0 font-weight-normal",attrs:{scope:"row"}},[t._v("原價")]),s("td",{staticClass:"text-right border-0 px-0"},[t._v("$"+t._s(t.originCartTotal))])]),s("tr",[s("th",{staticClass:"border-0 px-0 pt-0 font-weight-normal",attrs:{scope:"row"}},[t._v("折扣")]),s("td",{staticClass:"text-right border-0 px-0 pt-0"},[t._v("$"+t._s(t.discount))])])])]),s("div",{staticClass:"d-flex justify-content-between mt-4"},[s("p",{staticClass:"mb-0 h4 font-weight-bold"},[t._v("總計")]),s("p",{staticClass:"mb-0 h4 font-weight-bold"},[t._v("$"+t._s(t.cartTotal))])]),s("router-link",{staticClass:"btn btn-dark btn-block mt-4 rounded-0 py-3",attrs:{to:"/checkout"}},[t._v("確認訂單")])],2)])])],1)},i=[],o=(s("99af"),s("4160"),s("159b"),{name:"Cart",data:function(){return{isLoading:!1,tempProduct:{},products:[],carts:[],discount:0,cartTotal:0,originCartTotal:0,status:{loadingItem:"",loadingUpdateCart:""},messages:[{name:"失敗",content:"出現錯誤"},{name:"刪除成功",content:"已刪除商品"},{name:"加入成功",content:"已加入購物車"}]}},methods:{getProducts:function(){var t=this,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.isLoading=!0;var s="".concat("https://course-ec-api.hexschool.io/api","/").concat("289038e7-cea7-4a49-afd4-86ec766c3f7f","/ec/products?page=").concat(a);this.$http.get(s).then((function(a){t.products=a.data.data,t.isLoading=!1})).catch((function(){t.$bus.$emit("push-messages",t.messages[0]),$(".l-toast").toast("show"),t.isLoading=!1}))},addToCart:function(t){var a=this,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.isLoading=!0;var e="".concat("https://course-ec-api.hexschool.io/api","/").concat("289038e7-cea7-4a49-afd4-86ec766c3f7f","/ec/shopping"),i={product:t,quantity:s};this.$http.post(e,i).then((function(t){a.$bus.$emit("push-messages",a.messages[2]),$(".l-toast").toast("show"),a.getCart(),a.isLoading=!1})).catch((function(t){console.log(t.response),a.$bus.$emit("push-messages",a.messages[0]),$(".l-toast").toast("show"),a.isLoading=!1}))},getProduct:function(t){var a=this;this.isLoading=!0,this.status.loadingItem=t;var s="".concat("https://course-ec-api.hexschool.io/api","/").concat("289038e7-cea7-4a49-afd4-86ec766c3f7f","/ec/product/").concat(t);this.$http.get(s).then((function(t){a.status.loadingItem="",a.tempProduct=t.data.data,a.tempProduct.num=1,a.isLoading=!1})).catch((function(){a.$bus.$emit("push-messages",a.messages[0]),$(".l-toast").toast("show"),a.isLoading=!1}))},getCart:function(){var t=this;this.isLoading=!0;var a="".concat("https://course-ec-api.hexschool.io/api","/").concat("289038e7-cea7-4a49-afd4-86ec766c3f7f","/ec/shopping");this.$http.get(a).then((function(a){t.carts=a.data.data,t.updateTotal(),t.calculateDiscount(),t.isLoading=!1})).catch((function(){t.$bus.$emit("push-messages",t.messages[0]),$(".l-toast").toast("show"),t.isLoading=!1}))},updateTotal:function(){var t=this;this.cartTotal=0,this.carts.forEach((function(a){t.cartTotal+=a.product.price*a.quantity}))},updateQuantity:function(t,a){var s=this;this.isLoading=!0,this.status.loadingUpdateCart=t;var e="".concat("https://course-ec-api.hexschool.io/api","/").concat("289038e7-cea7-4a49-afd4-86ec766c3f7f","/ec/shopping"),i={product:t,quantity:a};this.$http.patch(e,i).then((function(t){s.status.loadingUpdateCart="",s.getCart(),s.isLoading=!1})).catch((function(t){console.log(t.response),s.$bus.$emit("push-messages",s.messages[0]),$(".l-toast").toast("show"),s.isLoading=!1}))},removeItem:function(t){var a=this,s="".concat("https://course-ec-api.hexschool.io/api","/").concat("289038e7-cea7-4a49-afd4-86ec766c3f7f","/ec/shopping/").concat(t);this.isLoading=!0,this.$http.delete(s).then((function(t){a.getCart(),a.$bus.$emit("get-cart"),a.messages.content=t.data.message,a.$bus.$emit("push-messages",a.messages[1]),$(".l-toast").toast("show"),a.isLoading=!1})).catch((function(){a.$bus.$emit("push-messages",a.messages[0]),$(".l-toast").toast("show"),a.isLoading=!1}))},deleteAllCartItem:function(){var t=this;this.isLoading=!0;var a="".concat("https://course-ec-api.hexschool.io/api","/").concat("289038e7-cea7-4a49-afd4-86ec766c3f7f","/ec/shopping/all/product");this.$http.delete(a).then((function(a){t.getCart(),t.$bus.$emit("get-cart"),t.$bus.$emit("push-messages",t.messages[1]),$(".l-toast").toast("show"),t.isLoading=!1})).catch((function(){t.$bus.$emit("push-messages",t.messages[0]),$(".l-toast").toast("show"),t.isLoading=!1})),this.cartTotal=0},calculateDiscount:function(){var t=this;this.discount=0,this.originCartTotal=0,this.carts.forEach((function(a){t.discount+=(a.product.origin_price-a.product.price)*a.quantity,t.originCartTotal+=a.product.origin_price*a.quantity}))}},created:function(){this.getProducts(),this.getCart()}}),n=o,c=s("2877"),r=Object(c["a"])(n,e,i,!1,null,null,null);a["default"]=r.exports}}]);
//# sourceMappingURL=chunk-2d21dca4.fdb235d6.js.map