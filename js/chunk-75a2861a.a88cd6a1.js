(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-75a2861a"],{"049c":function(t,e,a){},ba2f:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"l-checkout"},[a("Loading",{attrs:{active:t.isLoading},on:{"update:active":function(e){t.isLoading=e}}}),a("div",{staticClass:"pt-5 pb-7"},[a("div",{staticClass:"container"},[a("div",{staticClass:"row justify-content-center flex-md-row flex-column-reverse"},[a("div",{staticClass:"col-md-6"},[a("validation-observer",{scopedSlots:t._u([{key:"default",fn:function(e){var s=e.invalid,r=e.handleSubmit;return[a("div",{staticClass:"p-4 border "},[a("h4",{staticClass:"font-weight-bold"},[t._v("聯絡資料")]),a("form",{on:{submit:function(e){return e.preventDefault(),r(t.createOrder)}}},[a("div",{staticClass:"form-group mb-2"},[a("validation-provider",{attrs:{rules:"required|email"},scopedSlots:t._u([{key:"default",fn:function(e){var s=e.errors,r=e.classes;return[a("label",{staticClass:"text-muted mb-0",attrs:{for:"ContactMail"}},[t._v("Email")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.user.email,expression:"user.email"}],staticClass:"form-control rounded-0",class:r,attrs:{id:"ContactMail",name:"email",type:"email",placeholder:"example@gmail.com"},domProps:{value:t.user.email},on:{input:function(e){e.target.composing||t.$set(t.user,"email",e.target.value)}}}),s[0]?a("span",{staticClass:"text-danger"},[t._v(t._s(s[0]))]):t._e()]}}],null,!0)})],1),a("div",{staticClass:"form-group mb-2"},[a("validation-provider",{attrs:{rules:"required"},scopedSlots:t._u([{key:"default",fn:function(e){var s=e.errors,r=e.classes;return[a("label",{staticClass:"text-muted mb-0",attrs:{for:"ContactName"}},[t._v("收件人姓名")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.user.name,expression:"user.name"}],staticClass:"form-control rounded-0",class:r,attrs:{id:"ContactName",name:"姓名",type:"text",placeholder:"王大明"},domProps:{value:t.user.name},on:{input:function(e){e.target.composing||t.$set(t.user,"name",e.target.value)}}}),s[0]?a("span",{staticClass:"text-danger"},[t._v(t._s(s[0]))]):t._e()]}}],null,!0)})],1),a("div",{staticClass:"form-group mb-4"},[a("validation-provider",{attrs:{rules:"required|min:10"},scopedSlots:t._u([{key:"default",fn:function(e){var s=e.errors,r=e.classes;return[a("label",{staticClass:"text-muted mb-0",attrs:{for:"ContactPhone"}},[t._v("收件人手機號碼")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.user.tel,expression:"user.tel"}],staticClass:"form-control rounded-0",class:r,attrs:{id:"ContactPhone",name:"手機號碼",type:"tel",placeholder:"0933-123-123"},domProps:{value:t.user.tel},on:{input:function(e){e.target.composing||t.$set(t.user,"tel",e.target.value)}}}),s[0]?a("span",{staticClass:"text-danger"},[t._v(t._s(s[0]))]):t._e()]}}],null,!0)})],1),a("h4",{staticClass:"font-weight-bold mb-2"},[t._v("運送及付款資訊")]),a("div",{staticClass:"form-group"},[a("validation-provider",{attrs:{rules:"required"},scopedSlots:t._u([{key:"default",fn:function(e){var s=e.errors,r=e.classes;return[a("label",{staticClass:"text-muted mb-0",attrs:{for:"ContactAddress"}},[t._v("運送地址")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.user.address,expression:"user.address"}],staticClass:"form-control rounded-0",class:r,attrs:{id:"ContactAddress",name:"運送地址",type:"tel",placeholder:"地址"},domProps:{value:t.user.address},on:{input:function(e){e.target.composing||t.$set(t.user,"address",e.target.value)}}}),s[0]?a("span",{staticClass:"text-danger"},[t._v(t._s(s[0]))]):t._e()]}}],null,!0)})],1),a("div",{staticClass:"form-group"},[a("validation-provider",{attrs:{rules:"required"},scopedSlots:t._u([{key:"default",fn:function(e){var s=e.errors,r=e.classes;return[a("label",{staticClass:"text-muted",attrs:{for:"payment"}},[t._v("付款方式")]),a("select",{directives:[{name:"model",rawName:"v-model",value:t.user.payment,expression:"user.payment"}],staticClass:"form-control rounded-0",class:r,attrs:{id:"payment",name:"付款方式"},on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.user,"payment",e.target.multiple?a:a[0])}}},[a("option",{attrs:{value:"",disabled:""}},[t._v(" 請選擇付款方式 ")]),a("option",{attrs:{value:"WebATM"}},[t._v(" WebATM ")]),a("option",{attrs:{value:"ATM"}},[t._v(" ATM ")]),a("option",{attrs:{value:"Credit"}},[t._v(" 信用卡 ")]),a("option",{attrs:{value:"ApplePay"}},[t._v(" ApplePay ")]),a("option",{attrs:{value:"GooglePay"}},[t._v(" GooglePay ")])]),s[0]?a("span",{staticClass:"text-danger"},[t._v(t._s(s[0]))]):t._e()]}}],null,!0)})],1),a("button",{staticClass:"btn btn-dark btn-block py-3 px-7 rounded-0",attrs:{type:"submit",disabled:s}},[t._v("確定付款")])])]),a("router-link",{staticClass:"text-light btn btn-dark btn-block py-3 mt-5 rounded-0",attrs:{to:"/product"}},[a("i",{staticClass:"fas fa-chevron-left mr-2"}),t._v(" 回訂單列表 ")])]}}])})],1),a("div",{staticClass:"col-md-4"},[a("div",{staticClass:"border p-4 mb-4"},[a("h4",{staticClass:"mb-4 "},[t._v("訂單資料")]),t._l(t.carts,(function(e){return a("div",{key:e.product.id+1,staticClass:"d-flex mb-2"},[a("img",{staticClass:"mr-2",staticStyle:{width:"48px",height:"48px","object-fit":"cover"},attrs:{src:e.product.imageUrl,alt:""}}),a("div",{staticClass:"w-100"},[a("div",{staticClass:"d-flex justify-content-between font-weight-bold"},[a("p",{staticClass:"mb-0 font-weight-light"},[t._v(t._s(e.product.title))]),a("p",{staticClass:"mb-0 font-weight-light"},[t._v("x"+t._s(e.quantity))])]),a("div",{staticClass:"d-flex justify-content-between"},[a("p",{staticClass:"text-muted mb-0"},[a("small",[t._v(t._s(t._f("money")(e.product.origin_price)))])]),a("p",{staticClass:"mb-0"},[t._v(t._s(t._f("money")(e.product.price)))])])])])})),a("table",{staticClass:"table mt-4 border-top border-bottom text-muted"},[a("tbody",[a("tr",[a("th",{staticClass:"border-0 px-0 pt-4 font-weight-normal",attrs:{scope:"row"}},[t._v("折扣")]),a("td",{staticClass:"text-right border-0 px-0 pt-4"},[t._v(t._s(t._f("money")(t.discount)))])]),a("tr",[a("th",{staticClass:"border-0 px-0 pt-0 pb-4 font-weight-normal",attrs:{scope:"row"}},[t._v("付款方式")]),a("td",{staticClass:"text-right border-0 px-0 pt-0 pb-4"},[t._v(t._s(t.user.payment))])])])]),a("div",{staticClass:"d-flex justify-content-between mt-4"},[a("p",{staticClass:"mb-0 h4 font-weight-bold"},[t._v("總計")]),a("p",{staticClass:"mb-0 h4 font-weight-bold"},[t._v(t._s(t._f("money")(t.cartTotal)))])])],2)])])])])],1)},r=[],o=(a("99af"),a("4160"),a("159b"),{name:"Checkout",data:function(){return{isLoading:!1,tempProduct:{},products:[],carts:[],cartTotal:0,discount:0,status:{loadingItem:"",loadingUpdateCart:""},user:{name:"",email:"",tel:"",address:"",payment:"",message:""},messages:[{name:"失敗",content:"出現錯誤"}]}},methods:{updateTotal:function(){var t=this;this.cartTotal=0,this.discount=0,this.carts.forEach((function(e){t.cartTotal+=e.product.price*e.quantity,t.discount+=(e.product.origin_price-e.product.price)*e.quantity}))},getCart:function(){var t=this;this.isLoading=!0;var e="".concat("https://course-ec-api.hexschool.io/api","/").concat("289038e7-cea7-4a49-afd4-86ec766c3f7f","/ec/shopping");this.$http.get(e).then((function(e){t.carts=e.data.data,t.updateTotal(),t.$bus.$emit("get-cart"),t.isLoading=!1})).catch((function(){t.$bus.$emit("push-messages",t.messages[0]),$(".l-toast").toast("show"),t.isLoading=!1}))},createOrder:function(){var t=this;this.isLoading=!0;var e="".concat("https://course-ec-api.hexschool.io/api","/").concat("289038e7-cea7-4a49-afd4-86ec766c3f7f","/ec/orders");this.$http.post(e,this.user).then((function(e){e.data.data.id&&(t.getCart(),t.$router.push({path:"/checkout-success/".concat(e.data.data.id)}),t.isLoading=!1)})).catch((function(e){console.log(e.response.data.errors),t.$bus.$emit("push-messages",t.messages[0]),$(".l-toast").toast("show"),t.isLoading=!1}))}},created:function(){this.updateTotal(),this.getCart()}}),i=o,n=(a("f7aa"),a("2877")),l=Object(n["a"])(i,s,r,!1,null,"075655ba",null);e["default"]=l.exports},f7aa:function(t,e,a){"use strict";var s=a("049c"),r=a.n(s);r.a}}]);
//# sourceMappingURL=chunk-75a2861a.a88cd6a1.js.map